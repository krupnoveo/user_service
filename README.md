# Сервис пользователей (User Service)

## Обзор
Сервис пользователей - это микросервис, отвечающий за управление пользователями в приложении Barbershop. Он обрабатывает аутентификацию пользователей, управление профилями и другие операции, связанные с пользователями.

## Функциональность
- Регистрация и аутентификация пользователей
- Управление профилями пользователей
- Управление паролями
- Хранение и получение фотографий пользователей
- Контроль доступа на основе ролей (роли ADMIN, CLIENT, MASTER)

## Технологический стек
- Java 21
- Spring Boot 3.x
- Spring Data JPA
- Spring Security
- PostgreSQL
- Liquibase (для миграций базы данных)
- AWS S3 (Yandex Cloud S3-совместимое хранилище для фотографий пользователей)

## API Endpoints
Сервис предоставляет RESTful API для:
- Аутентификации пользователей
- Управления профилями пользователей
- Управления паролями
- Управления фотографиями

## Конфигурация
Сервис использует следующую конфигурацию:
- База данных: PostgreSQL
- Объектное хранилище: S3-совместимое хранилище (Yandex Cloud)

## Зависимости
- PostgreSQL: Хранение данных пользователей
- Gateway: Маршрутизация API

## Разработка
Для локального запуска сервиса:

1. Убедитесь, что PostgreSQL работает и создана база данных `user_db`
2. Примените миграции Liquibase
3. Установите необходимые переменные окружения (см. файл `.env`)
4. Запустите приложение: `./gradlew bootRun`

## Docker
Сервис можно развернуть с помощью Docker. Для этого необходимо скачать образ из Docker Hub и запустить командой:
```bash
docker run -p 5432:5432 postgres:16
docker run -p 8080:8080 --env-file .env -d --name user-service --network barbershop-network krupnoveo/barbershop_with_microservices_user-service
```

## Переменные окружения
- `user.service.name`: Имя сервиса для регистрации в Eureka
- `user.service.port`: Порт, на котором работает сервис
- `postgres.host`: Хост PostgreSQL
- `postgres.port`: Порт PostgreSQL
- `DB_USER`: Имя пользователя базы данных
- `DB_PASSWORD`: Пароль базы данных
- `JWT_SECRET_KEY`: Секретный ключ для генерации JWT-токенов
- `ACCESS_KEY`: Ключ доступа S3
- `SECRET_KEY`: Секретный ключ S3
- `eureka.service.host`: Хост Eureka сервера
- `eureka.service.port`: Порт Eureka сервера 